<!--
ä¿å­˜æ–¹æ³•ï¼š
1. å°†æ­¤æ•´ä¸ªæ–‡ä»¶å†…å®¹å¤åˆ¶å¹¶ç²˜è´´åˆ°è®°äº‹æœ¬æˆ–ä»»æ„æ–‡æœ¬ç¼–è¾‘å™¨ã€‚
2. å¦å­˜ä¸ºæ–‡ä»¶åï¼špinyin_game.html
   - ä¿å­˜ç±»å‹é€‰æ‹©ï¼šæ‰€æœ‰æ–‡ä»¶ï¼ˆAll Filesï¼‰
   - ç¼–ç é€‰æ‹©ï¼šUTF-8
3. å°† pinyin_game.html æ”¾åˆ°æ¡Œé¢ï¼ŒåŒå‡»å³å¯åœ¨é»˜è®¤æµè§ˆå™¨ä¸­æ‰“å¼€å¹¶è¿è¡Œæ¸¸æˆã€‚

è¯´æ˜ï¼ˆå¯é€‰ï¼‰ï¼šå¦‚æœæ‚¨å¸Œæœ›ä½¿ç”¨æ•™å¸ˆå½•åˆ¶çš„ã€100% ç¨³å®šçš„å‘éŸ³æ–‡ä»¶ï¼Œè¯·å‚è§æ–‡ä»¶åº•éƒ¨æ³¨é‡Šï¼ˆç¤ºä¾‹è¯´æ˜å¦‚ä½•æŠŠ pairs ä¸­æ¯é¡¹å¢åŠ  audio å­—æ®µå¹¶ç”¨ new Audio(url).play() æ’­æ”¾ï¼‰ã€‚
-->

<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>æ‹¼éŸ³å¯¹å¯¹ç¢° â€” æ¡Œé¢å°æ¸¸æˆï¼ˆçˆ¸çˆ¸/å¦ˆå¦ˆ/å¼Ÿå¼Ÿ/å¦¹å¦¹/å§å§/å“¥å“¥/è°¢è°¢/çˆ·çˆ·ï¼‰</title>
<style>
  :root{
    --bg:#f5f9ff; --card:#1e90ff; --card-plain:#ffffff; --accent:#06b6d4; --ok:#16a34a; --bad:#ef4444;
  }
  *{box-sizing:border-box}
  body{margin:0;font-family:system-ui,-apple-system,'Segoe UI',Roboto,'PingFang SC','Microsoft Yahei',sans-serif;background:var(--bg);color:#0f172a}
  .wrap{max-width:980px;margin:18px auto;padding:18px}
  header{display:flex;flex-direction:column;gap:8px;align-items:center}
  h1{margin:0;font-size:20px}
  .subtitle{font-size:13px;color:#475569;text-align:center}
  .controls{margin-top:10px;display:flex;flex-wrap:wrap;gap:8px;justify-content:center;align-items:center}
  select,input[type=range],button{padding:8px;border-radius:8px;border:1px solid #cbd5e1;background:#fff}
  button.primary{background:var(--accent);color:#fff;border:none;cursor:pointer}
  button.ghost{background:#fff;color:#0f172a;cursor:pointer}
  .layout{display:flex;gap:16px;margin-top:16px}
  .boardWrap{flex:1}
  .panel{width:320px;min-width:240px}
  .board{display:grid;grid-template-columns:repeat(4,1fr);gap:12px;padding:10px;justify-items:center}
  @media (max-width:840px){ .layout{flex-direction:column} .panel{width:100%} .board{grid-template-columns:repeat(2,1fr)} }
  .card{width:100%;aspect-ratio:1 / 1;border-radius:10px;background:var(--card);color:#fff;display:flex;align-items:center;justify-content:center;font-size:20px;cursor:pointer;user-select:none;box-shadow:0 8px 18px rgba(2,6,23,0.06);transition:transform .12s,background .12s}
  .card:active{transform:translateY(1px)}
  .card.flipped{background:var(--card-plain);color:#0f172a;border:2px solid var(--card)}
  .card.matched{background:var(--ok)!important;color:#fff;cursor:default}
  .info{padding:12px;background:#fff;border-radius:10px;box-shadow:0 6px 18px rgba(2,6,23,0.05)}
  .stat{display:flex;gap:12px;align-items:center;justify-content:space-between;margin-top:8px}
  .small{font-size:13px;color:#64748b}
  #message{margin-top:10px;font-weight:600}
  .footer{margin-top:12px;font-size:13px;color:#475569;text-align:center}
</style>
</head>
<body>
  <div class="wrap">
    <header>
      <h1>æ‹¼éŸ³å¯¹å¯¹ç¢°ï¼ˆæ¡Œé¢å°æ¸¸æˆï¼‰</h1>
      <div class="subtitle">ç»ƒä¹ è¯æ±‡ï¼šçˆ¸çˆ¸ / å¦ˆå¦ˆ / å¼Ÿå¼Ÿ / å¦¹å¦¹ / å§å§ / å“¥å“¥ / è°¢è°¢ / çˆ·çˆ·<br>ç‚¹å‡»å¡ç‰‡é…å¯¹æ‹¼éŸ³ä¸æ±‰å­—ï¼Œç‚¹å‡»æ—¶æ’­æ”¾æ ‡å‡†æ™®é€šè¯ï¼ˆä¼˜å…ˆç”¨æ±‰å­—æœ—è¯»ä»¥ç¡®ä¿å‘éŸ³å‡†ç¡®ï¼‰ã€‚</div>

      <div class="controls" role="region" aria-label="æ§åˆ¶é¢æ¿">
        <button id="startBtn" class="primary">å¼€å§‹æ¸¸æˆ</button>
        <button id="testVoiceBtn" class="ghost">æµ‹è¯•å‘éŸ³ï¼ˆæœ—è¯»â€œä½ å¥½â€ï¼‰</button>

        <label>
          è¯­éŸ³ï¼š
          <select id="voiceSelect" title="é€‰æ‹©è¯­éŸ³ï¼ˆè¯·é€‰æ‹©ä¸­æ–‡è¯­éŸ³ä»¥è·å¾—å‡†ç¡®çš„æ™®é€šè¯å‘éŸ³ï¼‰"></select>
        </label>

        <label>
          è¯­é€Ÿï¼š
          <input id="rate" type="range" min="0.6" max="1.4" step="0.05" value="0.95" />
        </label>

        <label>
          éŸ³é«˜ï¼š
          <input id="pitch" type="range" min="0.6" max="1.6" step="0.05" value="1" />
        </label>
      </div>
    </header>

    <main class="layout" role="main">
      <div class="boardWrap">
        <div id="gameBoard" class="board" aria-live="polite" aria-label="æ¸¸æˆæ£‹ç›˜"></div>
        <div id="message" class="small">ç‚¹å‡»â€œå¼€å§‹æ¸¸æˆâ€å¼€å§‹ã€‚</div>
      </div>

      <aside class="panel">
        <div class="info" aria-hidden="false">
          <div class="small">è¿›åº¦ä¸ç»Ÿè®¡</div>
          <div class="stat">
            <div>å·²é…å¯¹</div><div id="matchedCount">0 / 8</div>
          </div>
          <div class="stat">
            <div>ç”¨æ—¶</div><div id="elapsed">0s</div>
          </div>
          <div class="stat">
            <div>å¹³å‡ååº”</div><div id="avgTime">â€”</div>
          </div>

          <hr style="margin:10px 0;border:none;border-top:1px solid #eef2f7" />

          <div class="small">æç¤º</div>
          <div class="small" style="margin-top:6px;color:#475569">
            1) è‹¥å‘éŸ³ä¸å‡†ç¡®ï¼Œè¯·å°è¯•é€‰æ‹©ç³»ç»Ÿä¸­æ–‡è¯­éŸ³æˆ–å®‰è£…ä¸­æ–‡è¯­éŸ³åŒ…ã€‚<br>
            2) å¦‚éœ€å®Œå…¨ä¸€è‡´çš„æ•™å­¦å‘éŸ³ï¼Œè¯·ä½¿ç”¨ç¤ºä¾‹æ³¨é‡Šä¸­è¯´æ˜çš„â€œé¢„å½•éŸ³â€æ–¹æ¡ˆï¼ˆå°†éŸ³é¢‘æ–‡ä»¶åµŒå…¥é¡µé¢æˆ–æ”¾åœ¨æœ¬åœ°å¹¶å¼•ç”¨ï¼‰ã€‚
          </div>

          <hr style="margin:10px 0;border:none;border-top:1px solid #eef2f7" />

          <div class="small">ä¼šè¯æ—¥å¿—</div>
          <div id="log" style="max-height:160px;overflow:auto;margin-top:8px"></div>
        </div>
      </aside>
    </main>

    <div class="footer">è‹¥æµè§ˆå™¨æœªæ”¯æŒ SpeechSynthesisï¼Œå°†ä¼šæç¤ºå¹¶ä»å¯æ‰‹åŠ¨æŸ¥çœ‹å¡ç‰‡é…å¯¹ï¼ˆä½†ä¸ä¼šå‘éŸ³ï¼‰ã€‚</div>
  </div>

<script>
/* ===========================
   æ‹¼éŸ³å¯¹å¯¹ç¢° â€” å•æ–‡ä»¶å®ç°
   è¯´æ˜ï¼š
   - è¯æ±‡ï¼ˆå¿…é¡»åŒ…å«ä¸”ä»…åŒ…å«ï¼‰ï¼šçˆ¸çˆ¸ å¦ˆå¦ˆ å¼Ÿå¼Ÿ å¦¹å¦¹ å§å§ å“¥å“¥ è°¢è°¢ çˆ·çˆ·
   - å‘éŸ³é‡‡ç”¨æ±‰å­—æ–‡æœ¬æœ—è¯»ä»¥ä¿è¯å‘éŸ³å‡†ç¡®ï¼ˆå°½é‡é¿å…ç›´æ¥è®©åˆæˆè¯»æ‹¼éŸ³å­—æ¯ï¼‰ã€‚
   - é¡µé¢æä¾›è¯­éŸ³é€‰æ‹©ã€è¯­é€Ÿä¸éŸ³é«˜è°ƒèŠ‚ã€‚
   =========================== */

/* è¯è¡¨ï¼ˆæ‹¼éŸ³ä»¥å¸¸è§æ‹¼å†™å½¢å¼å«å£°è°ƒæˆ–éŸ³èŠ‚ï¼Œä¾‹å¦‚ 'bÃ ba'ï¼‰ */
const pairs = [
  { pinyin: 'bÃ ba', hanzi: 'çˆ¸çˆ¸' },
  { pinyin: 'mÄma', hanzi: 'å¦ˆå¦ˆ' },
  { pinyin: 'dÃ¬di', hanzi: 'å¼Ÿå¼Ÿ' },
  { pinyin: 'mÃ¨imei', hanzi: 'å¦¹å¦¹' },
  { pinyin: 'jiÄ›jie', hanzi: 'å§å§' },
  { pinyin: 'gÄ“ge', hanzi: 'å“¥å“¥' },
  { pinyin: 'xiÃ¨xie', hanzi: 'è°¢è°¢' },
  { pinyin: 'yÃ©ye', hanzi: 'çˆ·çˆ·' }
];

/* å…¨å±€çŠ¶æ€ */
let cards = []; // æ¯é¡¹ { text, type:'pinyin'|'hanzi', pair }
let flipped = []; // å½“å‰ç¿»å¼€çš„ä¸¤å¼  { card, div }
let matched = 0;
let startTime = 0;
let elapsedTimer = null;
let times = []; // è®°å½•æ¯é¢˜ç”¨æ—¶ï¼ˆç§’ï¼‰
let lockBoard = false;

/* UI å…ƒç´  */
const boardEl = document.getElementById('gameBoard');
const messageEl = document.getElementById('message');
const matchedCountEl = document.getElementById('matchedCount');
const elapsedEl = document.getElementById('elapsed');
const avgTimeEl = document.getElementById('avgTime');
const logEl = document.getElementById('log');

const startBtn = document.getElementById('startBtn');
const testVoiceBtn = document.getElementById('testVoiceBtn');
const voiceSelect = document.getElementById('voiceSelect');
const rateInput = document.getElementById('rate');
const pitchInput = document.getElementById('pitch');

/* è¯­éŸ³æ”¯æŒæ£€æµ‹ä¸è¯­éŸ³åˆ—è¡¨å¡«å…… */
let voices = [];
function populateVoices(){
  voices = speechSynthesis.getVoices() || [];
  voiceSelect.innerHTML = '';
  voices.forEach(v=>{
    const opt = document.createElement('option');
    opt.value = v.voiceURI;
    opt.textContent = `${v.name} â€” ${v.lang}`;
    voiceSelect.appendChild(opt);
  });
  // å°è¯•é»˜è®¤é€‰ä¸­æ–‡è¯­éŸ³ï¼ˆä¼˜å…ˆ zh-CN / zhï¼‰
  const zh = voices.find(v => v.lang && v.lang.toLowerCase().startsWith('zh'));
  if(zh) voiceSelect.value = zh.voiceURI;
  else if(voices.length) voiceSelect.value = voices[0].voiceURI;
}

/* è‹¥æµè§ˆå™¨æ”¯æŒ speechSynthesisï¼Œå¡«å……voicesï¼›å¦åˆ™ç»™å‡ºæç¤º */
if('speechSynthesis' in window){
  populateVoices();
  // some browsers load voices asynchronously
  window.speechSynthesis.onvoiceschanged = populateVoices;
} else {
  // ç¦ç”¨è¯­éŸ³æ§ä»¶å¹¶æç¤º
  voiceSelect.innerHTML = '<option>å½“å‰æµè§ˆå™¨ä¸æ”¯æŒè¯­éŸ³åˆæˆ</option>';
  messageEl.textContent = 'æç¤ºï¼šå½“å‰æµè§ˆå™¨ä¸æ”¯æŒ SpeechSynthesisï¼ˆè¯­éŸ³åˆæˆï¼‰ã€‚å»ºè®®ä½¿ç”¨æœ€æ–° Chrome/Edge/Safariã€‚';
}

/* å‘éŸ³å‡½æ•°ï¼šä½¿ç”¨æ±‰å­—æœ—è¯»ä»¥ç¡®ä¿æ™®é€šè¯å‘éŸ³å‡†ç¡® */
function speakHanzi(hanzi){
  if(!('speechSynthesis' in window)) return;
  window.speechSynthesis.cancel();
  const u = new SpeechSynthesisUtterance(hanzi);
  u.lang = 'zh-CN';
  // é€‰æ‹©ç”¨æˆ·æŒ‡å®šè¯­éŸ³ï¼ˆè‹¥å­˜åœ¨ï¼‰
  const sel = voiceSelect.value;
  if(sel && voices.length){
    const v = voices.find(x=>x.voiceURI === sel);
    if(v) u.voice = v;
  } else {
    // è‡ªåŠ¨é€‰æ‹© zh è¯­éŸ³
    const autoZh = voices.find(v=>v.lang && v.lang.toLowerCase().startsWith('zh'));
    if(autoZh) u.voice = autoZh;
  }
  u.rate = parseFloat(rateInput.value || 1);
  u.pitch = parseFloat(pitchInput.value || 1);
  window.speechSynthesis.speak(u);
}

/* æ„å»ºå¡ç‰‡ï¼šæ¯ä¸ª pair ç”Ÿæˆä¸€å¼ æ‹¼éŸ³å¡å’Œä¸€å¼ æ±‰å­—å¡ */
function buildCards(){
  cards = [];
  pairs.forEach(p=>{
    cards.push({ text: p.pinyin, type: 'pinyin', pair: p });
    cards.push({ text: p.hanzi, type: 'hanzi', pair: p });
  });
  // æ‰“ä¹±æ•°ç»„
  shuffle(cards);
}

/* Fisherâ€“Yates shuffle */
function shuffle(array){
  for(let i=array.length-1;i>0;i--){
    const j = Math.floor(Math.random()*(i+1));
    [array[i], array[j]] = [array[j], array[i]];
  }
  return array;
}

/* æ¸²æŸ“æ£‹ç›˜ */
function renderBoard(){
  boardEl.innerHTML = '';
  cards.forEach((c, idx)=>{
    const div = document.createElement('div');
    div.className = 'card';
    div.dataset.idx = idx;
    div.setAttribute('role','button');
    div.setAttribute('aria-label','å¡ç‰‡');
    div.addEventListener('click', ()=>onCardClick(div));
    boardEl.appendChild(div);
  });
}

/* ç‚¹å‡»å¡ç‰‡ */
function onCardClick(div){
  if(lockBoard) return;
  const idx = Number(div.dataset.idx);
  const card = cards[idx];

  if(div.classList.contains('flipped') || div.classList.contains('matched')) return;

  // æ˜¾ç¤ºæ–‡æœ¬ï¼ˆæ‹¼éŸ³æˆ–æ±‰å­—ï¼‰
  div.textContent = card.text;
  div.classList.add('flipped');

  // å‘éŸ³ï¼šå§‹ç»ˆæ’­æ”¾è¯¥è¯çš„æ±‰å­—å‘éŸ³ï¼ˆå³ä½¿ç”¨æˆ·ç‚¹çš„æ˜¯æ‹¼éŸ³å¡ï¼Œä¹Ÿç”¨ pair.hanzi è¯»ï¼‰
  const hanziToSpeak = (card.type === 'hanzi') ? card.text : (card.pair && card.pair.hanzi ? card.pair.hanzi : card.text);
  speakHanzi(hanziToSpeak);

  // è®°å½•æ—¶é—´ç‚¹ï¼ˆæ¯é¢˜çš„å¼€å§‹/ç»“æŸç”± flipped æ•°é‡æ¥æµ‹ï¼‰
  const now = Date.now();
  if(flipped.length === 0){
    // å¼€å§‹è®¡æ—¶è¯¥é¢˜
    div.dataset.startTime = now;
  }

  flipped.push({ card, div, time: now });

  if(flipped.length === 2){
    // é”å®šé¢æ¿ï¼ŒçŸ­å»¶æ—¶æ£€æŸ¥
    lockBoard = true;
    setTimeout(checkMatch, 450);
  }
}

/* æ£€æŸ¥æ˜¯å¦é…å¯¹æˆåŠŸ */
function checkMatch(){
  if(flipped.length < 2){ lockBoard=false; return; }
  const a = flipped[0], b = flipped[1];

  const isPair = (a.card.pair === b.card.pair) && (a.card.type !== b.card.type);

  // è®¡ç®—æœ¬é¢˜ç”¨æ—¶ï¼ˆä»¥ç¬¬äºŒæ¬¡ç‚¹å‡»æ—¶é—´å‡ç¬¬ä¸€æ¬¡ç‚¹å‡»æ—¶é—´ï¼‰
  const t0 = a.time || 0;
  const t1 = b.time || 0;
  const used = Math.max(0, (t1 - t0) / 1000);
  times.push(used);
  updateAvgTime();

  if(isPair){
    a.div.classList.add('matched');
    b.div.classList.add('matched');
    // å†æ¬¡ç¡®è®¤å‘éŸ³ï¼ˆæ’­æ”¾æ±‰å­—ï¼‰
    const hanzi = a.card.pair.hanzi;
    speakHanzi(hanzi);

    matched++;
    matchedCountEl.textContent = `${matched} / ${pairs.length}`;
    messageEl.textContent = `é…å¯¹æˆåŠŸï¼å·²é…å¯¹ ${matched} / ${pairs.length}`;

    if(matched === pairs.length){
      // å®Œæˆ
      const totalSec = Math.round((Date.now() - startTime)/1000);
      messageEl.textContent = `æ­å–œï¼å…¨éƒ¨å®Œæˆï¼Œç”¨æ—¶ ${totalSec} ç§’ ğŸ‰`;
      stopElapsedTimer();
    }
  } else {
    // ç¿»å›å»
    setTimeout(()=>{
      a.div.textContent = '';
      b.div.textContent = '';
      a.div.classList.remove('flipped');
      b.div.classList.remove('flipped');
    },700);
    messageEl.textContent = 'é…å¯¹é”™è¯¯ï¼Œè¯·å†è¯•ä¸€æ¬¡ã€‚';
  }

  // è®°å½•æ—¥å¿—
  pushLog(`${a.card.pair.hanzi} â€” ${a.card.type} vs ${b.card.type} â†’ ${isPair ? 'âˆš' : 'Ã—'}`);

  // æ¸…ç†
  flipped = [];
  lockBoard = false;
}

/* æ—¥å¿—æ¨é€ */
function pushLog(text){
  const li = document.createElement('div');
  li.textContent = `${new Date().toLocaleTimeString()} â€” ${text}`;
  logEl.prepend(li);
  // ä¿æŒä¸€å®šé•¿åº¦
  if(logEl.children.length > 100) logEl.removeChild(logEl.lastChild);
}

/* å¼€å§‹æ¸¸æˆ */
function startGame(){
  // è¯­éŸ³éœ€è¦ä¸€æ¬¡ç”¨æˆ·äº¤äº’åæ‰èƒ½æ’­æ”¾ï¼ˆå¤šæ•°æµè§ˆå™¨ï¼‰ï¼Œè¿™é‡ŒæŠŠ start è§†ä¸ºæ¿€æ´»äº¤äº’
  matched = 0;
  matchedCountEl.textContent = `${matched} / ${pairs.length}`;
  messageEl.textContent = 'æ¸¸æˆå¼€å§‹ï¼Œè¯·é…å¯¹å¡ç‰‡ã€‚';
  times = [];
  updateAvgTime();
  buildCards();
  renderBoard();
  startTime = Date.now();
  startElapsedTimer();
}

/* è®¡æ—¶å™¨ */
function startElapsedTimer(){
  stopElapsedTimer();
  elapsedTimer = setInterval(()=>{
    const sec = Math.round((Date.now() - startTime)/1000);
    elapsedEl.textContent = `${sec}s`;
  }, 500);
}
function stopElapsedTimer(){ if(elapsedTimer){ clearInterval(elapsedTimer); elapsedTimer = null; } }

/* å¹³å‡æ—¶é—´æ›´æ–° */
function updateAvgTime(){
  if(times.length === 0){ avgTimeEl.textContent = 'â€”'; return; }
  const avg = times.reduce((a,b)=>a+b,0) / times.length;
  avgTimeEl.textContent = `${avg.toFixed(1)}s`;
}

/* æµ‹è¯•è¯­éŸ³æŒ‰é’® */
function testVoice(){
  // æœ—è¯»â€œä½ å¥½â€ä»¥æµ‹è¯•è¯­éŸ³æ˜¯å¦å¯ç”¨
  speakHanzi('ä½ å¥½');
}

/* ç»‘å®šäº‹ä»¶ */
startBtn.addEventListener('click', ()=>{ startGame(); });
testVoiceBtn.addEventListener('click', ()=>{ testVoice(); });

/* ç•Œé¢åˆå§‹åŒ–ï¼šå°è¯•å¡«å……è¯­éŸ³å¹¶æç¤ºç”¨æˆ· */
window.addEventListener('load', ()=>{
  if(!('speechSynthesis' in window)){
    messageEl.textContent = 'æç¤ºï¼šå½“å‰æµè§ˆå™¨ä¸æ”¯æŒè¯­éŸ³åˆæˆï¼ˆSpeechSynthesisï¼‰ã€‚å»ºè®®ä½¿ç”¨ Chrome / Edge / Safari æœ€æ–°ç‰ˆæœ¬ä»¥è·å¾—å‘éŸ³åŠŸèƒ½ã€‚';
    voiceSelect.disabled = true;
    rateInput.disabled = true;
    pitchInput.disabled = true;
  } else {
    // å¦‚æœå£°éŸ³åˆ—è¡¨å°šæœªåŠ è½½å®Œæˆï¼ŒpopulateVoices ä¼šåœ¨ onvoiceschanged ä¸­é‡æ–°å¡«å……
    setTimeout(()=> {
      const v = speechSynthesis.getVoices();
      if(v && v.length) {
        // populate if not already
        if(voiceSelect.options.length === 0) {
          v.forEach(vi => {
            const opt = document.createElement('option');
            opt.value = vi.voiceURI;
            opt.textContent = `${vi.name} â€” ${vi.lang}`;
            voiceSelect.appendChild(opt);
          });
        }
        // å°è¯•è‡ªåŠ¨é€‰æ‹©ä¸­æ–‡è¯­éŸ³
        const zh = v.find(x=>x.lang && x.lang.toLowerCase().startsWith('zh'));
        if(zh) voiceSelect.value = zh.voiceURI;
      }
      // å¦‚æœä»æ— ä¸­æ–‡è¯­éŸ³ï¼Œé€šçŸ¥ç”¨æˆ·
      const zhFound = (speechSynthesis.getVoices()||[]).some(x=>x.lang && x.lang.toLowerCase().startsWith('zh'));
      if(!zhFound){
        messageEl.textContent = 'æç¤ºï¼šæœªæ£€æµ‹åˆ°ç³»ç»Ÿä¸­æ–‡è¯­éŸ³ã€‚è‹¥å‘éŸ³ä¸å‡†ç¡®ï¼Œè¯·å®‰è£…ä¸­æ–‡è¯­éŸ³åŒ…æˆ–ä½¿ç”¨é¢„å½•éŸ³æ–‡ä»¶ä»¥ä¿è¯å‘éŸ³ä¸€è‡´ï¼ˆè§é¡µé¢æç¤ºï¼‰ã€‚';
      } else {
        messageEl.textContent = 'å‡†å¤‡å°±ç»ªï¼Œç‚¹å‡»â€œå¼€å§‹æ¸¸æˆâ€ã€‚';
      }
    }, 300);
  }
});

/* simple helper to prefill voiceSelect if browser updates voices later */
window.speechSynthesis && (window.speechSynthesis.onvoiceschanged = () => {
  populateVoices();
});

/* é¢å¤–è¯´æ˜ï¼ˆå¦‚ä½•æ›¿æ¢ä¸ºé¢„å½•éŸ³æ–‡ä»¶ï¼‰
   å¦‚æœæ‚¨å¸Œæœ›ä¸ä¾èµ–æµè§ˆå™¨ TTSï¼Œè€Œä½¿ç”¨ç¦»çº¿çš„ã€å®Œå…¨å¯æ§çš„å‘éŸ³ï¼š
   1) ä¸ºæ¯ä¸ªè¯å½•åˆ¶ MP3ï¼ˆæˆ–ä½¿ç”¨ç°æœ‰å½•éŸ³ï¼‰ï¼Œä¾‹å¦‚ï¼šbaba.mp3, mama.mp3 ç­‰ã€‚
   2) åœ¨ pairs ä¸­å¢åŠ  audio å­—æ®µï¼š
      { pinyin:'bÃ ba', hanzi:'çˆ¸çˆ¸', audio:'baba.mp3' }
   3) åœ¨æ’­æ”¾å¤„ï¼ˆspeakHanzi / flip é€»è¾‘ï¼‰æ”¹ä¸ºï¼š
      if(card.pair.audio){ new Audio(card.pair.audio).play(); } else { speakHanzi(card.pair.hanzi); }
   4) è‹¥æƒ³æŠŠéŸ³é¢‘åµŒå…¥å•æ–‡ä»¶ HTMLï¼Œå¯æŠŠéŸ³é¢‘è½¬æ¢ä¸º Base64 å¹¶ç”¨ data:audio/mp3;base64,... ä½œä¸º audio å­—æ®µå€¼ã€‚
   è¯´æ˜ï¼šæˆ‘å¯ä»¥æŒ‰éœ€å¸®æ‚¨æŠŠ 8 ä¸ªè¯çš„ç¤ºä¾‹éŸ³é¢‘åµŒå…¥ä¸º base64ï¼ˆé¡µé¢æ‰“å¼€å³å¯ç¦»çº¿æ’­æ”¾ï¼‰ã€‚
*/

</script>
</body>
</html>
